<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">{% extends "admin/base_site.html" %}</span></p>
<p class="p1"><span class="s1">{% block content %}</span></p>
<p class="p1"><span class="s1">&lt;h1&gt;{{ title }}&lt;/h1&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- Debug Section --&gt;</span></p>
<p class="p1"><span class="s1">{% if debug_info %}</span></p>
<p class="p1"><span class="s1">&lt;div style="background: #fff3cd; border: 1px solid #ffeeba; padding: 10px; margin: 10px 0;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;strong&gt;Debug Info:&lt;/strong&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{% for key, value in debug_info.items %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;li&gt;&lt;strong&gt;{{ key }}:&lt;/strong&gt; {{ value }}&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{% endfor %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">{% endif %}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div class="results"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;form method="get" style="margin-bottom: 20px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label for="search-box"&gt;Search by name, email, phone, or employer:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="text" id="search-box" name="q" value="{{ search_query }}"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">               </span>placeholder="Enter name, email, phone, or employer name..."<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">               </span>style="width: 300px; padding: 5px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="submit" value="Search" class="default"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/form&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{% if search_query %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;h3&gt;Search Results for "{{ search_query }}"&lt;/h3&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{% if search_results %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{% for result in search_results %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="module" style="margin-bottom: 15px; padding: 15px; border: 1px solid #ddd;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h4&gt;{{ result.full_name }} → {{ result.employer_name }}&lt;/h4&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p&gt;&lt;strong&gt;Application ID:&lt;/strong&gt; {{ result.application_id }}&lt;/p&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 10px 0;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;strong&gt;Contact Info:&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Email: {{ result.email }}&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Phone: {{ result.phone }}&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Address: {{ result.address }}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;strong&gt;Application Details:&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Job: {{ result.job_title }}&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Employer: {{ result.employer_name }}&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>Applied: {{ result.application_date }}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div style="margin-top: 15px; padding: 15px; background-color: #f0f8ff; border: 2px solid #007cba;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h5 style="margin-top: 0;"&gt;Callback Status&lt;/h5&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;form class="callback-form" data-app-id="{{ result.application_id }}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>{% csrf_token %}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;input type="checkbox" name="callback_received"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                       </span>{% if result.callback_received %}checked{% endif %}&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;strong&gt;Callback Received&lt;/strong&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label&gt;&lt;strong&gt;Date:&lt;/strong&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;input type="date" name="callback_date"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                       </span>value="{% if result.callback_date %}{{ result.callback_date|date:'Y-m-d' }}{% endif %}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label&gt;&lt;strong&gt;Medium:&lt;/strong&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;select name="callback_medium"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value=""&gt;-- Select --&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value="phone" {% if result.callback_medium == 'phone' %}selected{% endif %}&gt;Phone call&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value="personalized_email" {% if result.callback_medium == 'personalized_email' %}selected{% endif %}&gt;Personalized email&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value="standardized_email" {% if result.callback_medium == 'standardized_email' %}selected{% endif %}&gt;Standardized email&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value="text" {% if result.callback_medium == 'text' %}selected{% endif %}&gt;Text message&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;option value="other" {% if result.callback_medium == 'other' %}selected{% endif %}&gt;Other&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label&gt;&lt;strong&gt;Notes:&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;textarea name="callback_notes" rows="3" cols="60"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                          </span>placeholder="Enter any notes about the callback..."&gt;{{ result.callback_notes }}&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button type="submit" class="default"<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                    </span>style="background: #007cba; color: white; padding: 8px 16px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                                </span>Update Callback Status</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span class="status-message" style="margin-left: 10px; font-weight: bold;"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/form&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>{% endfor %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{% else %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;p&gt;No applications found matching "{{ search_query }}".&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{% endif %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{% else %}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;p&gt;Enter a search term above to find applications for callback logging.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>{% endif %}</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">document.querySelectorAll('.callback-form').forEach(form =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>form.addEventListener('submit', function(e) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>e.preventDefault();</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const appId = this.dataset.appId;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const formData = new FormData(this);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const statusMessage = this.querySelector('.status-message');</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>fetch(`/admin/audit/callback-update/${appId}/`, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>body: formData,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>headers: {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.then(response =&gt; response.json())</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.then(data =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (data.success) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>statusMessage.textContent = '✓ Updated';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>statusMessage.style.color = 'green';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>statusMessage.textContent = '✗ Error: ' + (data.error || 'Unknown error');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>statusMessage.style.color = 'red';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>})</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.catch(error =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>statusMessage.textContent = '✗ Network error';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>statusMessage.style.color = 'red';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">{% endblock %}</span></p>
</body>
</html>
